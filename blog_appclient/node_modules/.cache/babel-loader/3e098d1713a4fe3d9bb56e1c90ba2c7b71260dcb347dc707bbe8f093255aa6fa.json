{"ast":null,"code":"import React from'react';import{useEffect,useState}from'react';import{useSelector}from'react-redux';import{useNavigate}from'react-router-dom';import axios from'axios';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";function Followers(){let[Authors,setAuthors]=useState([]);let[fol,setFol]=useState([]);let{currentUser}=useSelector(state=>state.userAuthorReducer);//get token from the local storage\nlet token=localStorage.getItem('token');//create the axios with token\nlet axiosWithToken=axios.create({headers:{Authorization:\"Bearer \".concat(token)}});const getAllAuthors=async()=>{//get http request for all authors\nlet res=await axiosWithToken.get('http://localhost:4000/author-api/authors');setAuthors(res.data.payload);};const getFollowersForAuthor=()=>{const currentAuthor=Authors.find(y=>y.username===currentUser.username);console.log(currentAuthor);if(currentAuthor&&currentAuthor.followers){let followersList=currentAuthor.followers.filter(follower=>follower.username).map(follower=>follower.username);setFol(followersList);}else{setFol([]);}};useEffect(()=>{getAllAuthors();getFollowersForAuthor();},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"m-3 ml-5 text-white\",children:[fol.length,\" Followers: \"]}),Authors.map((obj,ind)=>/*#__PURE__*/_jsx(\"div\",{className:\"m-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card d-flex gap-2 w-50 m-auto d-block\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"mt-2 mb-2\",children:obj.username}),/*#__PURE__*/_jsx(\"p\",{children:\"User details\"})]})})},ind)),/*#__PURE__*/_jsx(\"button\",{onClick:getFollowersForAuthor(),children:\"Click\"})]});}export default Followers;","map":{"version":3,"names":["React","useEffect","useState","useSelector","useNavigate","axios","jsxs","_jsxs","jsx","_jsx","Followers","Authors","setAuthors","fol","setFol","currentUser","state","userAuthorReducer","token","localStorage","getItem","axiosWithToken","create","headers","Authorization","concat","getAllAuthors","res","get","data","payload","getFollowersForAuthor","currentAuthor","find","y","username","console","log","followers","followersList","filter","follower","map","children","className","length","obj","ind","onClick"],"sources":["C:/Users/heman/blog_app/blog_appclient/src/components/Followers.js"],"sourcesContent":["import React from 'react'\r\nimport { useEffect, useState } from 'react'\r\nimport { useSelector } from 'react-redux'\r\nimport { useNavigate } from 'react-router-dom'\r\nimport axios from 'axios'\r\nfunction Followers() {\r\n\r\n    let [Authors,setAuthors]=useState([])\r\n    let [fol,setFol]=useState([])\r\n    let {currentUser}=useSelector(state=>state.userAuthorReducer)\r\n\r\n    //get token from the local storage\r\n    let token = localStorage.getItem('token')\r\n    //create the axios with token\r\n    let axiosWithToken=axios.create({\r\n        headers:{Authorization:`Bearer ${token}`}\r\n    })\r\n \r\n     const getAllAuthors= async()=>{\r\n         //get http request for all authors\r\n         let res=await axiosWithToken.get('http://localhost:4000/author-api/authors')\r\n         setAuthors(res.data.payload)\r\n     }\r\n     \r\n     const getFollowersForAuthor = () => {\r\n        const currentAuthor = Authors.find(y => y.username === currentUser.username);\r\n        console.log(currentAuthor)\r\n        if (currentAuthor && currentAuthor.followers) {\r\n            let followersList = currentAuthor.followers\r\n                .filter(follower => follower.username) \r\n                .map(follower => follower.username); \r\n                setFol(followersList);\r\n        } else {\r\n            setFol([]);\r\n        }\r\n    };\r\n\r\n     useEffect(()=>{\r\n        getAllAuthors()\r\n        getFollowersForAuthor()\r\n     },[])\r\n\r\n\r\n  return (\r\n    <div>\r\n        <h2 className='m-3 ml-5 text-white'>{fol.length} Followers: </h2>\r\n        {\r\n        Authors.map((obj,ind)=><div className=\"m-2\" key={ind}>\r\n            <div className='card d-flex gap-2 w-50 m-auto d-block'>\r\n                <div className='card-body'>\r\n                    <h3 className='mt-2 mb-2'>{obj.username}</h3>\r\n                    <p>User details</p>\r\n                </div>\r\n            </div>\r\n        </div>)\r\n        }\r\n        <button onClick={getFollowersForAuthor()}>Click</button>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Followers"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,OAASC,WAAW,KAAQ,aAAa,CACzC,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,KAAK,KAAM,OAAO,QAAAC,IAAA,IAAAC,KAAA,gCAAAC,GAAA,IAAAC,IAAA,yBACzB,QAAS,CAAAC,SAASA,CAAA,CAAG,CAEjB,GAAI,CAACC,OAAO,CAACC,UAAU,CAAC,CAACV,QAAQ,CAAC,EAAE,CAAC,CACrC,GAAI,CAACW,GAAG,CAACC,MAAM,CAAC,CAACZ,QAAQ,CAAC,EAAE,CAAC,CAC7B,GAAI,CAACa,WAAW,CAAC,CAACZ,WAAW,CAACa,KAAK,EAAEA,KAAK,CAACC,iBAAiB,CAAC,CAE7D;AACA,GAAI,CAAAC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CACzC;AACA,GAAI,CAAAC,cAAc,CAAChB,KAAK,CAACiB,MAAM,CAAC,CAC5BC,OAAO,CAAC,CAACC,aAAa,WAAAC,MAAA,CAAWP,KAAK,CAAE,CAC5C,CAAC,CAAC,CAED,KAAM,CAAAQ,aAAa,CAAE,KAAAA,CAAA,GAAS,CAC1B;AACA,GAAI,CAAAC,GAAG,CAAC,KAAM,CAAAN,cAAc,CAACO,GAAG,CAAC,0CAA0C,CAAC,CAC5EhB,UAAU,CAACe,GAAG,CAACE,IAAI,CAACC,OAAO,CAAC,CAChC,CAAC,CAED,KAAM,CAAAC,qBAAqB,CAAGA,CAAA,GAAM,CACjC,KAAM,CAAAC,aAAa,CAAGrB,OAAO,CAACsB,IAAI,CAACC,CAAC,EAAIA,CAAC,CAACC,QAAQ,GAAKpB,WAAW,CAACoB,QAAQ,CAAC,CAC5EC,OAAO,CAACC,GAAG,CAACL,aAAa,CAAC,CAC1B,GAAIA,aAAa,EAAIA,aAAa,CAACM,SAAS,CAAE,CAC1C,GAAI,CAAAC,aAAa,CAAGP,aAAa,CAACM,SAAS,CACtCE,MAAM,CAACC,QAAQ,EAAIA,QAAQ,CAACN,QAAQ,CAAC,CACrCO,GAAG,CAACD,QAAQ,EAAIA,QAAQ,CAACN,QAAQ,CAAC,CACnCrB,MAAM,CAACyB,aAAa,CAAC,CAC7B,CAAC,IAAM,CACHzB,MAAM,CAAC,EAAE,CAAC,CACd,CACJ,CAAC,CAEAb,SAAS,CAAC,IAAI,CACXyB,aAAa,CAAC,CAAC,CACfK,qBAAqB,CAAC,CAAC,CAC1B,CAAC,CAAC,EAAE,CAAC,CAGR,mBACExB,KAAA,QAAAoC,QAAA,eACIpC,KAAA,OAAIqC,SAAS,CAAC,qBAAqB,CAAAD,QAAA,EAAE9B,GAAG,CAACgC,MAAM,CAAC,cAAY,EAAI,CAAC,CAEjElC,OAAO,CAAC+B,GAAG,CAAC,CAACI,GAAG,CAACC,GAAG,gBAAGtC,IAAA,QAAKmC,SAAS,CAAC,KAAK,CAAAD,QAAA,cACvClC,IAAA,QAAKmC,SAAS,CAAC,uCAAuC,CAAAD,QAAA,cAClDpC,KAAA,QAAKqC,SAAS,CAAC,WAAW,CAAAD,QAAA,eACtBlC,IAAA,OAAImC,SAAS,CAAC,WAAW,CAAAD,QAAA,CAAEG,GAAG,CAACX,QAAQ,CAAK,CAAC,cAC7C1B,IAAA,MAAAkC,QAAA,CAAG,cAAY,CAAG,CAAC,EAClB,CAAC,CACL,CAAC,EANuCI,GAO5C,CAAC,CAAC,cAEPtC,IAAA,WAAQuC,OAAO,CAAEjB,qBAAqB,CAAC,CAAE,CAAAY,QAAA,CAAC,OAAK,CAAQ,CAAC,EACvD,CAAC,CAEV,CAEA,cAAe,CAAAjC,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}