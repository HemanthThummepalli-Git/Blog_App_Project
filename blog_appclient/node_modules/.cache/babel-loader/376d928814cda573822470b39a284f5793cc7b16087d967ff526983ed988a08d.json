{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useSelector}from'react-redux';import axios from'axios';import{useLocation}from'react-router-dom';import{FaUserGraduate}from\"react-icons/fa6\";import{toast}from'react-toastify';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function FollowAuthors(){const location=useLocation();const{mystate}=location.state;let{currentUser}=useSelector(state=>state.userAuthorReducer);let[currentAuthorList,setCurrentAuthorList]=useState(mystate);//get token from the local storage\nlet token=localStorage.getItem('token');//create the axios with token\nlet axiosWithToken=axios.create({headers:{Authorization:\"Bearer \".concat(token)}});const updateElement=(username,newValue)=>{const updatedState=currentAuthorList.map(item=>item.username===username?newValue:item);setCurrentAuthorList([...updatedState]);};const updateFollowStatus=async Author=>{let obj={};obj.username=currentUser.username;obj.followStatus=true;let res=await axiosWithToken.post(\"http://localhost:4000/author-api/authors/\".concat(Author.username),obj);if(res.data.message==\"Followers are updated\"){updateElement(res.data.payload.username,res.data.payload);toast.success('Followed author');}};const updateUnfollowStatus=async Author=>{let obj={};obj.username=currentUser.username;obj.followStatus=false;let res=await axiosWithToken.post(\"http://localhost:4000/author-api/authors/\".concat(Author.username),obj);if(res.data.message==\"Followers are updated\"){updateElement(res.data.payload.username,res.data.payload);toast.failure('Unfollowed author');}};return/*#__PURE__*/_jsx(\"div\",{children:mystate.length===0?/*#__PURE__*/_jsx(\"h2\",{className:\"text-white text-center m-3\",children:\"No Authors yet...\"}):/*#__PURE__*/_jsx(_Fragment,{children:currentAuthorList.map(obj=>/*#__PURE__*/_jsx(\"div\",{className:\"m-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card py-4 bg-light rounded-2 m-auto d-block\",style:{width:'250px'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body text-center m-auto d-block p-0\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"mb-4 mt-2\",children:[/*#__PURE__*/_jsx(FaUserGraduate,{}),\" \",obj.username]}),obj.followers.map(follower=>/*#__PURE__*/_jsxs(\"div\",{children:[follower.followStatus===true&&follower.username===currentUser.username&&/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary text-light\",onClick:()=>updateUnfollowStatus(obj),children:\"Unfollow\"}),follower.followStatus===false&&follower.username===currentUser.username&&/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success\",onClick:()=>updateFollowStatus(obj),children:\"Follow\"})]},follower.username)),// Render the follow button if followers array is null or does not include the currentUser\n(!obj.followers||obj.followers.every(follower=>follower.username!==currentUser.username))&&/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success\",onClick:()=>updateFollowStatus(obj),children:\"Follow\"})]})})},obj._id))})});}export default FollowAuthors;","map":{"version":3,"names":["React","useEffect","useState","useSelector","axios","useLocation","FaUserGraduate","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","FollowAuthors","location","mystate","state","currentUser","userAuthorReducer","currentAuthorList","setCurrentAuthorList","token","localStorage","getItem","axiosWithToken","create","headers","Authorization","concat","updateElement","username","newValue","updatedState","map","item","updateFollowStatus","Author","obj","followStatus","res","post","data","message","payload","success","updateUnfollowStatus","failure","children","length","className","style","width","followers","follower","onClick","every","_id"],"sources":["C:/Users/heman/Blog_Toast/blog_toast/blog_appclient/src/components/FollowAuthors.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { useSelector } from 'react-redux'\r\nimport axios from 'axios'\r\nimport { useLocation } from 'react-router-dom'\r\nimport { FaUserGraduate } from \"react-icons/fa6\";\r\nimport { toast } from 'react-toastify';\r\n\r\nfunction FollowAuthors() {\r\n\r\n    const location = useLocation()\r\n    const { mystate } = location.state\r\n    let {currentUser}=useSelector(state=>state.userAuthorReducer)\r\n    let [currentAuthorList,setCurrentAuthorList]=useState(mystate)\r\n\r\n\r\n    //get token from the local storage\r\n  let token = localStorage.getItem('token')\r\n  //create the axios with token\r\n  let axiosWithToken=axios.create({\r\n      headers:{Authorization:`Bearer ${token}`}\r\n  })\r\n\r\n\r\n  const updateElement = (username, newValue) => {\r\n    const updatedState = currentAuthorList.map(item => (item.username === username ? newValue : item));\r\n    setCurrentAuthorList([...updatedState]);\r\n  };\r\n\r\n    const updateFollowStatus= async(Author)=>{\r\n        let obj={}\r\n        obj.username=currentUser.username\r\n        obj.followStatus=true\r\n        let res=await axiosWithToken.post(`http://localhost:4000/author-api/authors/${Author.username}`,obj)\r\n        if(res.data.message==\"Followers are updated\")\r\n            {\r\n                updateElement(res.data.payload.username,res.data.payload)\r\n                toast.success('Followed author')\r\n            }\r\n    }\r\n\r\n    const updateUnfollowStatus= async(Author)=>{\r\n        let obj={}\r\n        obj.username=currentUser.username\r\n        obj.followStatus=false\r\n        let res=await axiosWithToken.post(`http://localhost:4000/author-api/authors/${Author.username}`,obj)\r\n        if(res.data.message==\"Followers are updated\")\r\n            {\r\n                updateElement(res.data.payload.username,res.data.payload)   \r\n                toast.failure('Unfollowed author')\r\n            }\r\n    }\r\n\r\n  return (\r\n    <div>\r\n        {mystate.length === 0?(\r\n            <h2 className='text-white text-center m-3'>No Authors yet...</h2>\r\n        ):(\r\n            <>\r\n            {\r\n                currentAuthorList.map(obj => (\r\n                    <div className=\"m-2\" key={obj._id}>\r\n                        <div className='card py-4 bg-light rounded-2 m-auto d-block' style={{width:'250px'}}>\r\n                            <div className='card-body text-center m-auto d-block p-0'>\r\n                                <h3 className='mb-4 mt-2'><FaUserGraduate /> {obj.username}</h3>\r\n                                {\r\n                                    obj.followers.map(follower => (\r\n                                        <div key={follower.username}>\r\n                                            {\r\n                                                (follower.followStatus === true && follower.username === currentUser.username) &&\r\n                                                <button className='btn btn-secondary text-light' onClick={() => updateUnfollowStatus(obj)}>Unfollow</button>\r\n                                            }\r\n                                            {\r\n                                                (follower.followStatus === false && follower.username === currentUser.username) &&\r\n                                                <button className='btn btn-success' onClick={() => updateFollowStatus(obj)}>Follow</button>\r\n                                            }\r\n                                        </div>\r\n                                    ))\r\n                                }\r\n                                {\r\n                                    // Render the follow button if followers array is null or does not include the currentUser\r\n                                    (!obj.followers || obj.followers.every(follower => follower.username !== currentUser.username)) &&\r\n                                    <button className='btn btn-success' onClick={() => updateFollowStatus(obj)}>Follow</button>\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                ))\r\n\r\n            }\r\n            \r\n            </>\r\n        )}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default FollowAuthors"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}